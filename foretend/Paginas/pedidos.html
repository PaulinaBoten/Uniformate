<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tu Cesta de Solicitudes - Uniformes CEFA</title> <!-- T칤tulo cambiado -->
  <link rel="stylesheet" href="/foretend/Paginas/CSS/pedidos.css">
  <!-- 칈conos de Font Awesome para el footer y WhatsApp -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
  <header class="logo"> 
    <div class="Letra">
      <h1>UNIFORMATE</h1>
    </div>
    <nav class="botones">
      <a href="/foretend/Paginas/prin.html">Inicio</a>
      <a href="/foretend/Paginas/cata.html">Cat치logo</a>
      <a href="/foretend/Paginas/comunicate.html" target="_blank">Cont치ctanos</a>
      <a href="/foretend/Paginas/inicio.html" id="enlaceUsuarios" style="display:none;">Usuarios</a> 
      <a href="/foretend/Paginas/Admin.html" id="enlaceAdmin" style="display:none;">Administrador</a>
      <a href="#" id="cerrarSesionBtn" style="display:none;">Cerrar sesi칩n</a>
    </nav>
  </header>

  <main class="container">
    <h1>Tu Cesta de Solicitudes</h1> <!-- T칤tulo cambiado -->

    <div class="cart-items" id="cartItems">
      <!-- Aqu칤 se renderizar치n los uniformes solicitados -->
      <p class="empty-cart-message" id="emptyCartMessage">No hay uniformes en tu cesta de solicitudes. Agrega desde el <a href="/foretend/Paginas/cata.html">cat치logo</a>.</p>
    </div>

    <!-- Secci칩n de total eliminada, ya que no hay precios para uniformes donados -->
    <!-- <div class="total-section">
      <h3>Total Estimado: $<span id="cartTotal">0.00</span></h3>
    </div> -->

    <div class="form-section">
      <h2>Confirma tus datos para la solicitud</h2> <!-- T칤tulo cambiado -->
      <form id="orderForm">
        <div class="form-group">
          <label for="fullName">Nombre Completo:</label>
          <input type="text" id="fullName" name="fullName" required readonly> <!-- Campo de solo lectura -->
        </div>
        <!-- Campo de estado del pedido eliminado, ya que el usuario no debe establecerlo -->
        
        <div class="form-group">
          <label for="orderDetails">Uniformes Solicitados:</label> <!-- Texto cambiado -->
          <textarea id="orderDetails" name="orderDetails" rows="5" readonly required></textarea>
          <small>Este campo se llenar치 autom치ticamente con los uniformes de tu cesta.</small>
        </div>
        
        <button type="submit" class="submit-button">Confirmar Solicitud</button> <!-- Texto del bot칩n cambiado -->
      </form>
    </div>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-box">
        <h3>游 Contacto</h3>
        <p><i class="fas fa-phone-alt"></i> 300 4197922</p>
        <p><i class="fas fa-map-marker-alt"></i> C 50 #41-55, La Candelaria, Medell칤n</p>
      </div>

      <div class="footer-box">
        <h3>游 Redes Sociales</h3>
        <a href="https://www.instagram.com/centroformativodeantioquia/" target="_blank">
          <i class="fab fa-instagram"></i> Instagram
        </a>
        <a href="https://wa.me/qr/NLHKB7NV3GKAI1" target="_blank">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
      </div>

      <div class="footer-box">
        <h3>游꿉 Cr칠ditos</h3>
        <p>Paulina Botero Gonz치lez</p>
        <p>Valeria Llano Quintero</p>
      </div>
    </div>
  </footer>

  <!-- Bot칩n flotante de WhatsApp -->
  <a href="https://wa.me/qr/NLHKB7NV3GKAI1" class="whatsapp-float" target="_blank" aria-label="Contactar por WhatsApp">
    <img src="/foretend/Paginas/img/whatsapp-white-icon.png" alt="WhatsApp">
    <i class="fab fa-whatsapp"></i>
  </a>

  <script type="module" src="/foretend/Paginas/JS/pedidos.js"></script>
  <!-- Script para protecci칩n de acceso y cerrar sesi칩n (restaurado) -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const token = sessionStorage.getItem('token');
        const userRole = sessionStorage.getItem('userRole');
        // Aseguramos que userFullName se obtenga si se guarda
        const userFullName = sessionStorage.getItem('userFullName');

        const cerrarSesionBtn = document.getElementById('cerrarSesionBtn');
        const enlaceUsuarios = document.getElementById('enlaceUsuarios');
        const enlaceAdmin = document.getElementById('enlaceAdmin');

        if (!token) {
            alert('Debes iniciar sesi칩n para ver tus solicitudes.'); // Mensaje m치s coherente
            window.location.href = 'inicio.html'; 
            return; // Detener la ejecuci칩n si redirigimos
        } else {
            console.log('Usuario autenticado. Rol:', userRole, 'Nombre:', userFullName);
            if (cerrarSesionBtn) cerrarSesionBtn.style.display = 'block';

            if (userRole === 'administrador') {
                if (enlaceAdmin) enlaceAdmin.style.display = 'block';
                if (enlaceUsuarios) enlaceUsuarios.style.display = 'none'; 
            } else { // Rol 'estudiante'
                if (enlaceAdmin) enlaceAdmin.style.display = 'none';
                // Si quieres que el enlaceUsuarios sea visible para estudiantes, ajusta aqu칤:
                // if (enlaceUsuarios) enlaceUsuarios.style.display = 'block';
            }

            // Precargar el nombre completo del usuario si est치 disponible
            const fullNameInput = document.getElementById('fullName');
            if (fullNameInput && userFullName) {
                fullNameInput.value = userFullName;
            }
        }

        if (cerrarSesionBtn) {
            cerrarSesionBtn.addEventListener('click', function(e) {
                e.preventDefault();

                sessionStorage.removeItem('token');
                sessionStorage.removeItem('userRole');
                sessionStorage.removeItem('userId');
                sessionStorage.removeItem('userEmail');
                sessionStorage.removeItem('userFullName');
                sessionStorage.removeItem('uniformBasket'); 

                alert('Has cerrado sesi칩n exitosamente.');
                window.location.href = 'inicio.html';
            });
        }
    });
  </script>
</body>
</html>